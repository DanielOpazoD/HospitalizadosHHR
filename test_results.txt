Warning: Starting in Storybook 8.5.0-alpha.18, the "test.include" option in Vitest is discouraged in favor of just using the "stories" field in your Storybook configuration.

The values you passed to "test.include" will be ignored, please remove them from your Vitest configuration where the Storybook plugin is applied.

More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#addon-test-indexing-behavior-of-storybookaddon-test-is-changed

[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mExcel Export Configuration[2m > [22mVite Configuration for ExcelJS[2m > [22mshould have exceljs in optimizeDeps.include[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mExcel Export Configuration[2m > [22mVite Configuration for ExcelJS[2m > [22mshould use namespace import for ExcelJS[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mExcel Export Configuration[2m > [22mExcel Export Integration[2m > [22mshould have manualChunks configured for vendor-excel[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mmoveOrCopyPatient[2m > [22mshould move patient from source to target and clear source[32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mmoveOrCopyPatient[2m > [22mshould copy patient to target without clearing source[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mmoveOrCopyPatient[2m > [22mshould not move/copy if source patient name is empty[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mclearAllBeds[2m > [22mshould clear all beds and reset metadata[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mtoggleExtraBed[2m > [22mshould add bed to activeExtraBeds if not present[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mtoggleExtraBed[2m > [22mshould remove bed from activeExtraBeds if already present[32m 1[2mms[22m[39m
 [31mÃ—[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mclearPatient[2m > [22mshould clear patient and call logPatientCleared if patientName exists[32m 5[2mms[22m[39m
[31m   â†’ expected "vi.fn()" to be called with arguments: [ 'B1', 'To Clear', â€¦(2) ][90m

Number of calls: [1m0[22m
[31m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mtoggleBlockBed[2m > [22mshould block an unblocked bed with a reason[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mtoggleBlockBed[2m > [22mshould unblock a blocked bed[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould throw error when no records provided[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould generate workbook with single day record[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould generate workbook with multiple days sorted[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould include all patient data in worksheet[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould handle record with no discharges/transfers/cma[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould handle record with empty beds only[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould set workbook metadata[32m 1[2mms[22m[39m
 [31mÃ—[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mgetCensusMasterFilename[2m > [22mshould generate correct filename format[32m 7[2mms[22m[39m
[31m   â†’ expected 'Censo diario HHR 23-12-2024.xlsx' to contain 'Hospital Hanga Roa'[39m
 [31mÃ—[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mgetCensusMasterFilename[2m > [22mshould include month name in Spanish[32m 2[2mms[22m[39m
[31m   â†’ expected 'censo diario hhr 15-12-2024.xlsx' to contain 'diciembre'[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mFull Month Export Simulation[2m > [22mshould handle 15 consecutive days export[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mFull Month Export Simulation[2m > [22mshould handle month transition correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mEdge Cases[2m > [22mshould handle patient with clinical crib[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mEdge Cases[2m > [22mshould handle blocked beds[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mEdge Cases[2m > [22mshould handle UPC patients[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mEdge Cases[2m > [22mshould exclude empty extra beds and include occupied ones[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mNursing Handoff[2m > [22mshould update nursing checklist[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mNursing Handoff[2m > [22mshould update nursing novedades and audit it[32m 2[2mms[22m[39m
 [31mÃ—[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mMedical Signature & WhatsApp[2m > [22mshould update medical signature with doctor name and timestamp[32m 3[2mms[22m[39m
[31m   â†’ logEvent is not a function[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mMedical Signature & WhatsApp[2m > [22mshould send medical handoff via WhatsApp and patch the record[32m 16[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mMedical Signature & WhatsApp[2m > [22mshould use signature mode URL in WhatsApp message[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mEdge Cases[2m > [22mshould handle missing record in handoff management[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mEdge Cases[2m > [22mshould fallback to previous day doctor if current is empty when sending[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mcensusMasterWorkbook[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould throw error when records array is empty[32m 298[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mcensusMasterWorkbook[2m > [22mbuildCensusMasterWorkbook[2m > [22mshould throw error when records is null/undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mcensusMasterWorkbook[2m > [22mcreateWorkbook helper[2m > [22mshould create a valid workbook object[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mcensusRawWorkbook[2m > [22mbuildCensusDailyRawWorkbook[2m > [22mshould create workbook with Censo Diario worksheet[32m 11[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mcensusRawWorkbook[2m > [22mbuildCensusDailyRawWorkbook[2m > [22mshould include header row[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mcensusRawWorkbook[2m > [22mextractRowsFromRecord[2m > [22mshould extract rows for each bed[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelExport.test.ts[2m > [22mreportService[2m > [22msaveWorkbook helper[2m > [22mshould use file-saver to download file[32m 58[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusMasterWorkbook.test.ts[2m > [22mcensus master workbook builder[2m > [22mcreates one sheet per day sorted by date with header content intact[32m 15[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusMasterWorkbook.test.ts[2m > [22mcensus master workbook builder[2m > [22mreturns a Buffer that can be reopened as Excel and preserves sheet names[32m 79[2mms[22m[39m
[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render empty bed correctly
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render empty bed correctly
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mrenders patient name and bed name correctly
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mrenders patient name and bed name correctly
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render patient data correctly
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould initialize with record for the given date[32m 70[2mms[22m[39m
[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render patient data correctly
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mtoggles UPC status when clicked
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mtoggles UPC status when clicked
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render blocked bed with visual indicator
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render blocked bed with visual indicator
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mcalls updatePatient when status changes
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mcalls updatePatient when status changes
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render UPC patient with special indicator
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatientRow Component[2m > [22m[2mshould render UPC patient with special indicator
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mCrib and Bed Mode Management[2m > [22m[2mtoggles bed mode when config button is clicked
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mCrib and Bed Mode Management[2m > [22m[2mtoggles bed mode when config button is clicked
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatient with Devices[2m > [22m[2mshould display devices correctly
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patient.test.tsx[2m > [22mPatient Management Integration[2m > [22mPatientRow Component[2m > [22mshould render empty bed correctly[32m 48[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patient.test.tsx[2m > [22mPatient Management Integration[2m > [22mPatientRow Component[2m > [22mshould render patient data correctly[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patient.test.tsx[2m > [22mPatient Management Integration[2m > [22mPatientRow Component[2m > [22mshould render blocked bed with visual indicator[32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patient.test.tsx[2m > [22mPatient Management Integration[2m > [22mPatientRow Component[2m > [22mshould render UPC patient with special indicator[32m 7[2mms[22m[39m
[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mCrib and Bed Mode Management[2m > [22m[2mtoggles companion crib when RN Sano button is clicked
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/integration/patient.test.tsx[2m > [22m[2mPatient Management Integration[2m > [22m[2mPatient with Devices[2m > [22m[2mshould display devices correctly
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mCrib and Bed Mode Management[2m > [22m[2mtoggles companion crib when RN Sano button is clicked
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patient.test.tsx[2m > [22mPatient Management Integration[2m > [22mPatient with Devices[2m > [22mshould display devices correctly[32m 24[2mms[22m[39m
[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mCrib and Bed Mode Management[2m > [22m[2mtoggles clinical crib when Cuna ClÃ­nica button is clicked
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mCrib and Bed Mode Management[2m > [22m[2mtoggles clinical crib when Cuna ClÃ­nica button is clicked
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mBlocked Bed View[2m > [22m[2mrenders blocked message and reason instead of inputs
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mrenders patient name and bed name correctly[32m 36[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mtoggles UPC status when clicked[32m 11[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mcalls updatePatient when status changes[32m 9[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mCrib and Bed Mode Management[2m > [22mtoggles bed mode when config button is clicked[32m 15[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mCrib and Bed Mode Management[2m > [22mtoggles companion crib when RN Sano button is clicked[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mCrib and Bed Mode Management[2m > [22mtoggles clinical crib when Cuna ClÃ­nica button is clicked[32m 11[2mms[22m[39m
[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mBlocked Bed View[2m > [22m[2mrenders blocked message and reason instead of inputs
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mDemographics Modal[2m > [22m[2mopens demographics modal and saves changes
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mDemographics Modal[2m > [22m[2mopens demographics modal and saves changes
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAction Menu[2m > [22m[2mcalls onAction when copy, move, discharge, or transfer is clicked
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAction Menu[2m > [22m[2mcalls onAction when copy, move, discharge, or transfer is clicked
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould update record when date changes[32m 109[2mms[22m[39m
[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAction Menu[2m > [22m[2mcloses menu when clicking background overlay
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAction Menu[2m > [22m[2mcloses menu when clicking background overlay
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAdmission Time and Input Logic[2m > [22m[2mshows admission time input when admission date is focused
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mBlocked Bed View[2m > [22mrenders blocked message and reason instead of inputs[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mDemographics Modal[2m > [22mopens demographics modal and saves changes[32m 32[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mAction Menu[2m > [22mcalls onAction when copy, move, discharge, or transfer is clicked[32m 36[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mAction Menu[2m > [22mcloses menu when clicking background overlay[32m 31[2mms[22m[39m
[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAdmission Time and Input Logic[2m > [22m[2mshows admission time input when admission date is focused
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAdmission Time and Input Logic[2m > [22m[2mtriggers updatePatient on debounced name change
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mAdmission Time and Input Logic[2m > [22m[2mtriggers updatePatient on debounced name change
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstderr[2m | tests/hooks/useDailyRecord.test.tsx[2m > [22m[2museDailyRecord[2m > [22m[2mshould not move patient if source bed is empty
[22m[39mCannot move empty patient from bed1

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Management - Edge Cases[2m > [22m[2mremoves clinical crib if it already exists
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Management - Edge Cases[2m > [22m[2mremoves clinical crib if it already exists
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould create a new day[32m 70[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould not move patient if source bed is empty[32m 58[2mms[22m[39m
[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Management - Edge Cases[2m > [22m[2mdoes not allow companion crib if in Cuna mode
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Management - Edge Cases[2m > [22m[2mdoes not allow companion crib if in Cuna mode
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

[90mstderr[2m | tests/hooks/useDailyRecord.test.tsx[2m > [22m[2museDailyRecord[2m > [22m[2mshould not update admissionDate to a future date
[22m[39mValidation failed for admissionDate: La fecha de ingreso no puede ser futura

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Sub-row[2m > [22m[2mrenders sub-row when clinicalCrib exists
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Sub-row[2m > [22m[2mrenders sub-row when clinicalCrib exists
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patientFlow.test.tsx[2m > [22mPatient Flow Integration[2m > [22mshould handle a full patient lifecycle: admission, update, discharge, undo[32m 284[2mms[22m[39m
[90mstderr[2m | tests/hooks/useDailyRecord.test.tsx[2m > [22m[2museDailyRecord[2m > [22m[2mshould not create clinical crib in empty bed
[22m[39mCannot add clinical crib to empty bed bed1

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Sub-row[2m > [22m[2mopens sub-row demographics modal
[22m[39m[useAuthState] ðŸš€ Initializing Auth System...
[useAuthState] ðŸ“¡ Subscribing to Firebase Auth changes...
[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: test@hospital.cl
[authService] ðŸ” Checking whitelist for: test@hospital.cl

[90mstdout[2m | tests/components/PatientRow.test.tsx[2m > [22m[2mPatientRow Component[2m > [22m[2mClinical Crib Sub-row[2m > [22m[2mopens sub-row demographics modal
[22m[39m[useAuthState] ðŸ§¹ Cleaning up Auth subscription

 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mAdmission Time and Input Logic[2m > [22mshows admission time input when admission date is focused[32m 25[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mAdmission Time and Input Logic[2m > [22mtriggers updatePatient on debounced name change[32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mClinical Crib Management - Edge Cases[2m > [22mremoves clinical crib if it already exists[32m 37[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mClinical Crib Management - Edge Cases[2m > [22mdoes not allow companion crib if in Cuna mode[32m 18[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mClinical Crib Sub-row[2m > [22mrenders sub-row when clinicalCrib exists[32m 29[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/PatientRow.test.tsx[2m > [22mPatientRow Component[2m > [22mClinical Crib Sub-row[2m > [22mopens sub-row demographics modal[32m 43[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould not update admissionDate to a future date[32m 56[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould not create clinical crib in empty bed[32m 59[2mms[22m[39m
[90mstderr[2m | tests/hooks/useDailyRecord.test.tsx[2m > [22m[2museDailyRecord[2m > [22m[2mshould not update crib admissionDate to a future date
[22m[39mCannot set admission date to future

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecord.test.tsx[2m > [22museDailyRecord[2m > [22mshould not update crib admissionDate to a future date[32m 55[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/patientFlow.test.tsx[2m > [22mPatient Flow Integration[2m > [22mshould handle patient transfer and undo[32m 220[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mrenders brand logo and name[32m 32[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mcalls onToggle when brand button is clicked[32m 127[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mshows menu items when isOpen is true[32m 11[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mshows admin-only items for admin users[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mhides admin items for non-admin users[32m 9[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mcalls onClose when backdrop is clicked[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mtoggles analytics view when statistic is clicked[32m 54[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarMenu.test.tsx[2m > [22mNavbarMenu[2m > [22mshows Reports when visible in modules[32m 52[2mms[22m[39m
[90mstderr[2m | tests/integration/firebaseSync.test.ts[2m > [22m[2mFirebase Sync Integration[2m > [22m[2mDailyRecord Sync[2m > [22m[2mshould include nurse and TENS fields when saving record
[22m[39mâŒ Failed to create history snapshot: TypeError: Cannot read properties of undefined (reading 'exists')
    at saveHistorySnapshot [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mservices/storage/firestoreService.ts:146:21[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at saveRecordToFirestore [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mservices/storage/firestoreService.ts:222:9[90m)[39m
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/integration/firebaseSync.test.ts:72:13
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:20

[90mstdout[2m | tests/integration/firebaseSync.test.ts[2m > [22m[2mFirebase Sync Integration[2m > [22m[2mDailyRecord Sync[2m > [22m[2mshould include nurse and TENS fields when saving record
[22m[39mâœ… Saved to Firestore: 2025-12-13

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/firebaseSync.test.ts[2m > [22mFirebase Sync Integration[2m > [22mDailyRecord Sync[2m > [22mshould include nurse and TENS fields when saving record[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/firebaseSync.test.ts[2m > [22mFirebase Sync Integration[2m > [22mDailyRecord Sync[2m > [22mshould preserve all record fields through save cycle[32m 66[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/firebaseSync.test.ts[2m > [22mFirebase Sync Integration[2m > [22mDailyRecord Sync[2m > [22mshould handle empty nurse/TENS arrays[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/firebaseSync.test.ts[2m > [22mFirebase Sync Integration[2m > [22mCatalog Sync[2m > [22mshould save and retrieve nurse catalog from localStorage[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/firebaseSync.test.ts[2m > [22mFirebase Sync Integration[2m > [22mCatalog Sync[2m > [22mshould handle empty catalogs[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/firebaseSync.test.ts[2m > [22mFirebase Sync Integration[2m > [22mData Integrity[2m > [22mshould not lose data during JSON serialization[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeleton Base[2m > [22mshould render with default props[32m 25[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeleton Base[2m > [22mshould apply animation class based on prop[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeleton Base[2m > [22mshould apply variant class for circular[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecordSyncQuery.test.tsx[2m > [22museDailyRecordSyncQuery[2m > [22mshould fetch the record on mount[32m 95[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeleton Base[2m > [22mshould apply custom width and height[32m 137[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeleton Base[2m > [22mshould apply string width and height[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonRow[2m > [22mshould render with default columns[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonRow[2m > [22mshould render with custom column count[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonTable[2m > [22mshould render with default rows[32m 14[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonTable[2m > [22mshould render with custom row count[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonTable[2m > [22mshould render header when showHeader is true[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonCard[2m > [22mshould render without avatar by default[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonCard[2m > [22mshould render with avatar when showAvatar is true[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mSkeletonCard[2m > [22mshould render with custom line count[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mCensusTableSkeleton[2m > [22mshould render census-specific skeleton[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mCensusTableSkeleton[2m > [22mshould render header stats section[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/Skeleton.test.tsx[2m > [22mSkeleton Components[2m > [22mHandoffSkeleton[2m > [22mshould render handoff-specific skeleton[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecordSyncQuery.test.tsx[2m > [22museDailyRecordSyncQuery[2m > [22mshould handle updates via saveAndUpdate[32m 62[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mrenders user initial button[32m 109[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mshows dropdown when button is clicked[32m 25[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mdisplays role correctly[32m 18[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mcalls onLogout when logout button is clicked[32m 9[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mcloses dropdown after logout[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mhas correct title attribute with email[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/UserMenu.test.tsx[2m > [22mUserMenu[2m > [22mshows first letter uppercase[32m 4[2mms[22m[39m
[90mstdout[2m | tests/services/dailyRecordRepository.test.ts[2m > [22m[2mDailyRecordRepository (Expanded)[2m > [22m[2mupdatePartial[2m > [22m[2mupdates local and remote data using dot notation
[22m[39m[Repository] updatePartial called: 2024-12-28 [ [32m'beds.R1.patientName'[39m ]

[90mstdout[2m | tests/services/dailyRecordRepository.test.ts[2m > [22m[2mDailyRecordRepository (Expanded)[2m > [22m[2mupdatePartial[2m > [22m[2mupdates local and remote data using dot notation
[22m[39m[Repository] Sending partial update to Firestore: 2024-12-28

[90mstdout[2m | tests/services/dailyRecordRepository.test.ts[2m > [22m[2mDailyRecordRepository (Expanded)[2m > [22m[2mupdatePartial[2m > [22m[2msilently catches firestore errors to protect local data
[22m[39m[Repository] updatePartial called: 2024-12-28 [ [32m'nurses'[39m ]

[90mstdout[2m | tests/services/dailyRecordRepository.test.ts[2m > [22m[2mDailyRecordRepository (Expanded)[2m > [22m[2mupdatePartial[2m > [22m[2msilently catches firestore errors to protect local data
[22m[39m[Repository] Sending partial update to Firestore: 2024-12-28

[90mstderr[2m | tests/services/dailyRecordRepository.test.ts[2m > [22m[2mDailyRecordRepository (Expanded)[2m > [22m[2mupdatePartial[2m > [22m[2msilently catches firestore errors to protect local data
[22m[39mFirestore partial update failed: Error: Network Fail
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/services/dailyRecordRepository.test.ts:77:83
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mupdatePartial[2m > [22mupdates local and remote data using dot notation[32m 34[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mupdatePartial[2m > [22msilently catches firestore errors to protect local data[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22minitializeDay[2m > [22minherits staff and notes from previous night shift correctly[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22minitializeDay[2m > [22mclears clinical crib notes during inheritance if they were empty[32m 14[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22minitializeDay[2m > [22mprefers firestore record if it exists[32m 11[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mensureMonthIntegrity[2m > [22mfills missing days and returns detailed result[32m 30[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mgetForDate[2m > [22mreturns record from storage when it exists[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mgetForDate[2m > [22muses demo storage in demo mode[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mCatalog Operations[2m > [22mmanages nurse catalog locally and syncs to firestore[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mCatalog Operations[2m > [22mmanages TENS catalog locally and syncs to firestore[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mMaintenance Operations[2m > [22mdeletes records locally and from firestore[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dailyRecordRepository.test.ts[2m > [22mDailyRecordRepository (Expanded)[2m > [22mMaintenance Operations[2m > [22msyncs from firestore and saves locally[32m 5[2mms[22m[39m
[90mstderr[2m | tests/hooks/movementCounters.test.ts[2m > [22m[2mMovement Counters[2m > [22m[2mDischarge Counter (Altas)[2m > [22m[2mshould not add discharge for empty bed
[22m[39mAttempted to discharge empty bed: bed-3

[90mstderr[2m | tests/hooks/movementCounters.test.ts[2m > [22m[2mMovement Counters[2m > [22m[2mTransfer Counter (Traslados)[2m > [22m[2mshould not add transfer for empty bed
[22m[39mAttempted to transfer empty bed: bed-3

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mDischarge Counter (Altas)[2m > [22mshould start with 0 discharges when array is empty[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mDischarge Counter (Altas)[2m > [22mshould increase discharge count by 1 when adding a discharge[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mDischarge Counter (Altas)[2m > [22mshould correctly count multiple discharges[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mDischarge Counter (Altas)[2m > [22mshould decrease discharge count when deleting[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mDischarge Counter (Altas)[2m > [22mshould not add discharge for empty bed[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mTransfer Counter (Traslados)[2m > [22mshould start with 0 transfers when array is empty[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mTransfer Counter (Traslados)[2m > [22mshould increase transfer count by 1 when adding a transfer[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mTransfer Counter (Traslados)[2m > [22mshould correctly count multiple transfers[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mTransfer Counter (Traslados)[2m > [22mshould decrease transfer count when deleting[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mTransfer Counter (Traslados)[2m > [22mshould not add transfer for empty bed[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mCMA Counter (Hospitalizaciones Diurnas)[2m > [22mshould start with 0 CMA when array is empty[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mCMA Counter (Hospitalizaciones Diurnas)[2m > [22mshould increase CMA count by 1 when adding[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mCMA Counter (Hospitalizaciones Diurnas)[2m > [22mshould correctly count multiple CMA entries[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mCMA Counter (Hospitalizaciones Diurnas)[2m > [22mshould decrease CMA count when deleting[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mCombined Counters[2m > [22mshould maintain independent counts for all movement types[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/movementCounters.test.ts[2m > [22mMovement Counters[2m > [22mCombined Counters[2m > [22mshould correctly calculate total movements[32m 0[2mms[22m[39m
[90mstderr[2m | tests/utils/networkUtils.test.ts[2m > [22m[2mnetworkUtils[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[networkUtils] Attempt 1 failed. Retrying in 10ms... Error: fail 1
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/utils/networkUtils.test.ts:14:36
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

[90mstderr[2m | tests/utils/networkUtils.test.ts[2m > [22m[2mnetworkUtils[2m > [22m[2mshould retry on failure and eventually succeed
[22m[39m[networkUtils] Attempt 2 failed. Retrying in 20ms... Error: fail 2
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/utils/networkUtils.test.ts:15:36
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

[90mstderr[2m | tests/utils/networkUtils.test.ts[2m > [22m[2mnetworkUtils[2m > [22m[2mshould throw last error if all retries fail
[22m[39m[networkUtils] Attempt 1 failed. Retrying in 1ms... Error: final fail
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/utils/networkUtils.test.ts:24:46
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

[90mstderr[2m | tests/utils/networkUtils.test.ts[2m > [22m[2mnetworkUtils[2m > [22m[2mshould throw last error if all retries fail
[22m[39m[networkUtils] Attempt 2 failed. Retrying in 2ms... Error: final fail
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/utils/networkUtils.test.ts:24:46
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/networkUtils.test.ts[2m > [22mnetworkUtils[2m > [22mshould return result if first attempt succeeds[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/networkUtils.test.ts[2m > [22mnetworkUtils[2m > [22mshould retry on failure and eventually succeed[32m 43[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/networkUtils.test.ts[2m > [22mnetworkUtils[2m > [22mshould throw last error if all retries fail[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/networkUtils.test.ts[2m > [22mnetworkUtils[2m > [22mshould call onRetry callback[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/BaseModal.test.tsx[2m > [22mBaseModal z-index behavior[2m > [22mshould have a z-index higher than Navbar (z-50)[32m 40[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/BaseModal.test.tsx[2m > [22mBaseModal z-index behavior[2m > [22mshould render with fixed positioning and cover the entire viewport[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/BaseModal.test.tsx[2m > [22mBaseModal z-index behavior[2m > [22mshould not render when isOpen is false[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/BaseModal.test.tsx[2m > [22mBaseModal z-index behavior[2m > [22mshould have backdrop blur effect[32m 4[2mms[22m[39m
[90mstdout[2m | tests/hooks/useDailyRecordSync.test.ts[2m > [22m[2museDailyRecordSync - Reconnection Logic[2m > [22m[2mshould push local data to Firestore if Online and isFirebaseConnected is true
[22m[39m[Sync] Initializing Firestore subscription for: 2025-12-27
[useDailyRecordSync] Deep sync triggered for: 2025-12-27

[90mstdout[2m | tests/hooks/useDailyRecordSync.test.ts[2m > [22m[2museDailyRecordSync - Reconnection Logic[2m > [22m[2mshould push local data to Firestore if Online and isFirebaseConnected is true
[22m[39m[useDailyRecordSync] Local data found but no Firestore record. Pushing local to cloud.

[90mstderr[2m | tests/integration/offline-persistence.test.ts[2m > [22m[2mOffline Persistence Integration[2m > [22m[2mshould save to localStorage even if Firestore fails
[22m[39mFirestore sync failed, data saved in IndexedDB: Error: Network Failure
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/integration/offline-persistence.test.ts:44:81
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/offline-persistence.test.ts[2m > [22mOffline Persistence Integration[2m > [22mshould save to localStorage even if Firestore fails[32m 14[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/offline-persistence.test.ts[2m > [22mOffline Persistence Integration[2m > [22mshould not call Firestore if disabled[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/offline-persistence.test.ts[2m > [22mOffline Persistence Integration[2m > [22mshould initialize day from local storage if firestore fails[32m 1[2mms[22m[39m
[90mstdout[2m | tests/hooks/useDailyRecordSync.test.ts[2m > [22m[2museDailyRecordSync - Reconnection Logic[2m > [22m[2mshould pull from Firestore if Online and NO local data exists
[22m[39m[Sync] Initializing Firestore subscription for: 2025-12-27
[useDailyRecordSync] Deep sync triggered for: 2025-12-27

[90mstdout[2m | tests/hooks/useDailyRecordSync.test.ts[2m > [22m[2museDailyRecordSync - Reconnection Logic[2m > [22m[2mshould pull from Firestore if Online and NO local data exists
[22m[39m[useDailyRecordSync] Firestore version is newer or local missing. Updating state.

[90mstdout[2m | tests/hooks/useDailyRecordSync.test.ts[2m > [22m[2museDailyRecordSync - Reconnection Logic[2m > [22m[2mshould NOT sync if navigator is offline
[22m[39m[Sync] Initializing Firestore subscription for: 2025-12-27

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecordSync.test.ts[2m > [22museDailyRecordSync - Reconnection Logic[2m > [22mshould push local data to Firestore if Online and isFirebaseConnected is true[32m 76[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecordSync.test.ts[2m > [22museDailyRecordSync - Reconnection Logic[2m > [22mshould pull from Firestore if Online and NO local data exists[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useDailyRecordSync.test.ts[2m > [22museDailyRecordSync - Reconnection Logic[2m > [22mshould NOT sync if navigator is offline[32m 4[2mms[22m[39m
[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museNurseManagement[2m > [22m[2mupdateNurse[2m > [22m[2mshould send complete array when updating day shift nurse at index 0
[22m[39m[NurseManagement] updateNurse called: day [33m0[39m MarÃ­a LÃ³pez record: [33mtrue[39m
[NurseManagement] Sending complete array: nursesDayShift = [ [32m'MarÃ­a LÃ³pez'[39m, [32m''[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museNurseManagement[2m > [22m[2mupdateNurse[2m > [22m[2mshould send complete array when updating day shift nurse at index 1
[22m[39m[NurseManagement] updateNurse called: day [33m1[39m Juan PÃ©rez record: [33mtrue[39m
[NurseManagement] Sending complete array: nursesDayShift = [ [32m'MarÃ­a LÃ³pez'[39m, [32m'Juan PÃ©rez'[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museNurseManagement[2m > [22m[2mupdateNurse[2m > [22m[2mshould send complete array when updating night shift nurse
[22m[39m[NurseManagement] updateNurse called: night [33m1[39m Pedro Soto record: [33mtrue[39m
[NurseManagement] Sending complete array: nursesNightShift = [ [32m'Ana GarcÃ­a'[39m, [32m'Pedro Soto'[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museNurseManagement[2m > [22m[2mupdateNurse[2m > [22m[2mshould not call patchRecord if record is null
[22m[39m[NurseManagement] updateNurse called: day [33m0[39m Test Nurse record: [33mfalse[39m

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museNurseManagement[2m > [22m[2mupdateNurse[2m > [22m[2mshould handle undefined nursesDayShift gracefully
[22m[39m[NurseManagement] updateNurse called: day [33m0[39m Test Nurse record: [33mtrue[39m
[NurseManagement] Sending complete array: nursesDayShift = [ [32m'Test Nurse'[39m, [32m''[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museNurseManagement[2m > [22m[2mupdateNurse[2m > [22m[2mshould preserve existing nurses when updating one slot
[22m[39m[NurseManagement] updateNurse called: day [33m0[39m New Nurse record: [33mtrue[39m
[NurseManagement] Sending complete array: nursesDayShift = [ [32m'New Nurse'[39m, [32m'Existing Nurse 2'[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museTensManagement[2m > [22m[2mupdateTens[2m > [22m[2mshould send complete array when updating day shift TENS at index 0
[22m[39m[TensManagement] Sending complete array: tensDayShift = [ [32m'Carlos FernÃ¡ndez'[39m, [32m''[39m, [32m''[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museTensManagement[2m > [22m[2mupdateTens[2m > [22m[2mshould send complete array when updating day shift TENS at index 2
[22m[39m[TensManagement] Sending complete array: tensDayShift = [ [32m'TENS 1'[39m, [32m'TENS 2'[39m, [32m'TENS 3'[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museTensManagement[2m > [22m[2mupdateTens[2m > [22m[2mshould send complete array when updating night shift TENS
[22m[39m[TensManagement] Sending complete array: tensNightShift = [ [32m'Night TENS 1'[39m, [32m'Night TENS 2'[39m, [32m''[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museTensManagement[2m > [22m[2mupdateTens[2m > [22m[2mshould handle undefined tensDayShift gracefully
[22m[39m[TensManagement] Sending complete array: tensDayShift = [ [32m'Test TENS'[39m, [32m''[39m, [32m''[39m ]

[90mstdout[2m | tests/hooks/useNurseManagement.test.ts[2m > [22m[2museTensManagement[2m > [22m[2mupdateTens[2m > [22m[2mshould preserve existing TENS when updating one slot
[22m[39m[TensManagement] Sending complete array: tensDayShift = [ [32m'TENS A'[39m, [32m'New TENS'[39m, [32m'TENS C'[39m ]

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museNurseManagement[2m > [22mupdateNurse[2m > [22mshould send complete array when updating day shift nurse at index 0[32m 9[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museNurseManagement[2m > [22mupdateNurse[2m > [22mshould send complete array when updating day shift nurse at index 1[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museNurseManagement[2m > [22mupdateNurse[2m > [22mshould send complete array when updating night shift nurse[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museNurseManagement[2m > [22mupdateNurse[2m > [22mshould not call patchRecord if record is null[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museNurseManagement[2m > [22mupdateNurse[2m > [22mshould handle undefined nursesDayShift gracefully[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museNurseManagement[2m > [22mupdateNurse[2m > [22mshould preserve existing nurses when updating one slot[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museTensManagement[2m > [22mupdateTens[2m > [22mshould send complete array when updating day shift TENS at index 0[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museTensManagement[2m > [22mupdateTens[2m > [22mshould send complete array when updating day shift TENS at index 2[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museTensManagement[2m > [22mupdateTens[2m > [22mshould send complete array when updating night shift TENS[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museTensManagement[2m > [22mupdateTens[2m > [22mshould not call patchRecord if record is null[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museTensManagement[2m > [22mupdateTens[2m > [22mshould handle undefined tensDayShift gracefully[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useNurseManagement.test.ts[2m > [22museTensManagement[2m > [22mupdateTens[2m > [22mshould preserve existing TENS when updating one slot[32m 1[2mms[22m[39m
[90mstderr[2m | tests/hooks/useHandoffLogic.test.ts[2m > [22m[2museHandoffLogic - Staff List Synchronization[2m > [22m[2mdeliversList - Census as Source of Truth[2m > [22m[2mshould return nursesNightShift when selectedShift is night
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | tests/hooks/useHandoffLogic.test.ts[2m > [22m[2museHandoffLogic - Staff List Synchronization[2m > [22m[2mtensList - Census as Source of Truth[2m > [22m[2mshould return tensNightShift when selectedShift is night
[22m[39mAn update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mdeliversList - Census as Source of Truth[2m > [22mshould return nursesDayShift when selectedShift is day[32m 9[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mdeliversList - Census as Source of Truth[2m > [22mshould return nursesNightShift when selectedShift is night[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mdeliversList - Census as Source of Truth[2m > [22mshould return empty array when nursesDayShift is undefined[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mdeliversList - Census as Source of Truth[2m > [22mshould return empty array when record is null[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mreceivesList - Census as Source of Truth[2m > [22mshould return nursesNightShift when selectedShift is day (night nurses receive)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mtensList - Census as Source of Truth[2m > [22mshould return tensDayShift when selectedShift is day[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mtensList - Census as Source of Truth[2m > [22mshould return tensNightShift when selectedShift is night[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mData Flow Integrity[2m > [22mshould NOT use handoffDayDelivers (deprecated field)[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useHandoffLogic.test.ts[2m > [22museHandoffLogic - Staff List Synchronization[2m > [22mData Flow Integrity[2m > [22mshould reflect census changes immediately[32m 6[2mms[22m[39m
[90mstderr[2m | tests/integration/concurrency.test.ts[2m > [22m[2mConcurrency Handling Integration[2m > [22m[2mshould handle ConcurrencyError correctly
[22m[39mSave failed: ConcurrencyError: Remote is newer
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/integration/concurrency.test.ts:54:36
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/concurrency.test.ts[2m > [22mConcurrency Handling Integration[2m > [22mshould handle ConcurrencyError correctly[32m 28[2mms[22m[39m
[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould load local record on mount
[22m[39m[Sync] Initializing Firestore subscription for: 2024-12-28
[useDailyRecordSync] Deep sync triggered for: 2024-12-28

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould load local record on mount
[22m[39m[useDailyRecordSync] Local data found but no Firestore record. Pushing local to cloud.

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould subscribe to remote changes on mount
[22m[39m[Sync] Initializing Firestore subscription for: 2024-12-28
[useDailyRecordSync] Deep sync triggered for: 2024-12-28

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould update record when remote change is received (no local pending)
[22m[39m[Sync] Initializing Firestore subscription for: 2024-12-28
[useDailyRecordSync] Deep sync triggered for: 2024-12-28

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould update record when remote change is received (no local pending)
[22m[39m[Sync] Applying remote change, lastUpdated: 2024-12-28T13:00:00Z

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould save and update state on saveAndUpdate call
[22m[39m[Sync] Initializing Firestore subscription for: 2024-12-28
[useDailyRecordSync] Deep sync triggered for: 2024-12-28

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould perform patch update and keep state in sync
[22m[39m[Sync] Initializing Firestore subscription for: 2024-12-28
[useDailyRecordSync] Deep sync triggered for: 2024-12-28

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould perform patch update and keep state in sync
[22m[39m[useDailyRecordSync] Local data found but no Firestore record. Pushing local to cloud.

[90mstdout[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould handle save errors and update syncStatus
[22m[39m[Sync] Initializing Firestore subscription for: 2024-12-28
[useDailyRecordSync] Deep sync triggered for: 2024-12-28

[90mstderr[2m | tests/integration/daily-record-sync.test.ts[2m > [22m[2mDailyRecord Sync Integration[2m > [22m[2mshould handle save errors and update syncStatus
[22m[39mSave failed: Error: Firebase error
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/integration/daily-record-sync.test.ts:195:36
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/daily-record-sync.test.ts[2m > [22mDailyRecord Sync Integration[2m > [22mshould load local record on mount[32m 16[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/daily-record-sync.test.ts[2m > [22mDailyRecord Sync Integration[2m > [22mshould subscribe to remote changes on mount[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/daily-record-sync.test.ts[2m > [22mDailyRecord Sync Integration[2m > [22mshould update record when remote change is received (no local pending)[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/daily-record-sync.test.ts[2m > [22mDailyRecord Sync Integration[2m > [22mshould save and update state on saveAndUpdate call[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/daily-record-sync.test.ts[2m > [22mDailyRecord Sync Integration[2m > [22mshould perform patch update and keep state in sync[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/daily-record-sync.test.ts[2m > [22mDailyRecord Sync Integration[2m > [22mshould handle save errors and update syncStatus[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mrenders visible tabs[32m 30[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mdoes not render hidden tabs[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mcalls onModuleChange when tab is clicked[32m 43[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mapplies active style to current module[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mrenders CENSUS tab correctly[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mrenders NURSING_HANDOFF tab correctly[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/NavbarTabs.test.tsx[2m > [22mNavbarTabs[2m > [22mrenders MEDICAL_HANDOFF tab correctly[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceSelector.test.tsx[2m > [22mDeviceSelector[2m > [22mwhen disabled (readOnly mode)[2m > [22mshould render device badges when disabled with devices[32m 105[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceSelector.test.tsx[2m > [22mDeviceSelector[2m > [22mwhen disabled (readOnly mode)[2m > [22mshould render placeholder when disabled with no devices[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceSelector.test.tsx[2m > [22mDeviceSelector[2m > [22mwhen disabled (readOnly mode)[2m > [22mshould not be clickable when disabled[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceSelector.test.tsx[2m > [22mDeviceSelector[2m > [22mwhen enabled (edit mode)[2m > [22mshould render clickable container with devices[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceSelector.test.tsx[2m > [22mDeviceSelector[2m > [22mwhen enabled (edit mode)[2m > [22mshould render plus icon when no devices[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useScrollLock.test.ts[2m > [22museScrollLock[2m > [22mshould lock scroll when isActive is true[32m 62[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useScrollLock.test.ts[2m > [22museScrollLock[2m > [22mshould not lock scroll when isActive is false[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould export featureFlags instance[32m 86[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould export isFeatureEnabled helper[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould export FEATURE_FLAGS constant[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould return default values for flags[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould enable and disable flags[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould toggle flags[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould get all flags[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/featureFlags.test.ts[2m > [22mFeatureFlags[2m > [22mshould reset flags to defaults[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useScrollLock.test.ts[2m > [22museScrollLock[2m > [22mshould keep scroll locked if at least one hook is active[32m 35[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useScrollLock.test.ts[2m > [22museScrollLock[2m > [22mshould unlock scroll when all hooks are unmounted[32m 6[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useScrollLock.test.ts[2m > [22museScrollLock[2m > [22mshould update scroll state when isActive changes[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModule Navigation[2m > [22mshould initialize with CENSUS module[32m 15[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModule Navigation[2m > [22mshould update current module[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mCensus View Mode[2m > [22mshould initialize with REGISTER view mode[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mCensus View Mode[2m > [22mshould toggle to ANALYTICS view mode[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModal States[2m > [22mshould have settingsModal with isOpen false initially[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModal States[2m > [22mshould open settings modal[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModal States[2m > [22mshould close settings modal[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModal States[2m > [22mshould have bedManagerModal functional[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mModal States[2m > [22mshould have demoModal functional[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mTest Agent State[2m > [22mshould initialize isTestAgentRunning as false[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mTest Agent State[2m > [22mshould update test agent running state[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mDerived State: showPrintButton[2m > [22mshould be false for CENSUS module[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mDerived State: showPrintButton[2m > [22mshould be true for CUDYR module[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mDerived State: showPrintButton[2m > [22mshould be true for NURSING_HANDOFF module[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useAppState.test.ts[2m > [22museAppState[2m > [22mDerived State: showPrintButton[2m > [22mshould be true for MEDICAL_HANDOFF module[32m 0[2mms[22m[39m
[90mstderr[2m | tests/hooks/useBedManagement.test.ts[2m > [22m[2museBedManagement[2m > [22m[2mupdatePatient[2m > [22m[2mshould not update admissionDate to future date
[22m[39mValidation failed for admissionDate: La fecha de ingreso no puede ser futura

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mupdatePatient[2m > [22mshould update a single patient field via patchRecord[32m 15[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mupdatePatient[2m > [22mshould not update admissionDate to future date[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mupdatePatientMultiple[2m > [22mshould update multiple fields atomically via patchRecord[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mclearPatient[2m > [22mshould reset patient via patchRecord[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mtoggleBlockBed[2m > [22mshould block bed via patchRecord[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mtoggleExtraBed[2m > [22mshould update activeExtraBeds via patchRecord[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mupdateCudyr[2m > [22mshould update Cudyr score field via patchRecord[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useBedManagement.test.ts[2m > [22museBedManagement[2m > [22mAudit Logging[2m > [22mshould log patient admission when patientName is set for the first time[32m 1[2mms[22m[39m
[90mstderr[2m | tests/services/tableConfigService.test.ts[2m > [22m[2mtableConfigService[2m > [22m[2mloadTableConfig[2m > [22m[2mshould handle errors by returning default config
[22m[39mError loading table config: Error: Firestore error
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/services/tableConfigService.test.ts:68:49
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22mgetDefaultConfig[2m > [22mshould return default values[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22mloadTableConfig[2m > [22mshould return default config if document does not exist[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22mloadTableConfig[2m > [22mshould return merged config if document exists[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22mloadTableConfig[2m > [22mshould handle errors by returning default config[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22msaveTableConfig[2m > [22mshould call setDoc with config and timestamp[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22mimportTableConfig[2m > [22mshould parse valid JSON file and return config[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/tableConfigService.test.ts[2m > [22mtableConfigService[2m > [22mimportTableConfig[2m > [22mshould throw error for invalid JSON[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mformatPatientName[2m > [22mshould capitalize each word and trim whitespace[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mformatPatientName[2m > [22mshould return original value if empty[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mvalidateRut[2m > [22mshould format a valid raw RUT[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mvalidateRut[2m > [22mshould detect and preserve passport format[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mvalidateRut[2m > [22mshould return trimmed invalid RUT as-is but valid[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mvalidateAdmissionDate[2m > [22mshould reject a future date[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mvalidateAdmissionDate[2m > [22mshould accept today or a past date[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mprocessFieldValue[2m > [22mshould route patientName to formatPatientName[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mprocessFieldValue[2m > [22mshould route rut to validateRut[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mprocessFieldValue[2m > [22mshould route admissionDate to validateAdmissionDate[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientValidation.test.ts[2m > [22musePatientValidation[2m > [22mprocessFieldValue[2m > [22mshould return other fields as-is[32m 2[2mms[22m[39m
[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould save a record with integrity snapshot
[22m[39mðŸ“œ History snapshot created for 2024-12-24

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould save a record with integrity snapshot
[22m[39mâœ… Saved to Firestore: 2024-12-24

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould perform a partial update with snapshot
[22m[39mðŸ“œ History snapshot created for 2024-12-24

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould perform a partial update with snapshot
[22m[39mâœ… Partial update to Firestore: 2024-12-24 [ [32m'beds.BED_01.patientName'[39m ]

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould sanitize corrupted array data from Firestore (object with numeric keys)
[22m[39m[Firestore] Converted object to array: { [32m'0'[39m: [32m'Nurse A'[39m, [32m'1'[39m: [32m'Nurse B'[39m } -> [ [32m'Nurse A'[39m, [32m'Nurse B'[39m ]

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould allow access if user is in whitelist
[22m[39m[authService] ðŸ” Checking whitelist for: daniel.opazo@hospitalhangaroa.cl

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould save nurse catalog to firestore
[22m[39mâœ… Nurse catalog saved to Firestore

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould handle catalog subscriptions correctly
[22m[39m[Firestore] Setting up nurse catalog subscription...
[Firestore] Nurse catalog snapshot received, exists: [33mtrue[39m
[Firestore] Nurse catalog data: [ [32m'Staff 1'[39m ]

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould save TENS catalog to firestore
[22m[39mâœ… TENS catalog saved to Firestore

[90mstderr[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould handle catalog fetch errors gracefully
[22m[39mError fetching nurse catalog from Firestore: Error: Firestore error
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/services/firestoreService.test.ts:209:38
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m

[90mstdout[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould handle subscription errors
[22m[39m[Firestore] Setting up nurse catalog subscription...

[90mstderr[2m | tests/services/firestoreService.test.ts[2m > [22m[2mfirestoreService[2m > [22m[2mshould handle subscription errors
[22m[39mâŒ Error subscribing to nurse catalog: Error: Sub error
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/services/firestoreService.test.ts:230:34
    at Mock [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/spy/dist/index.js:285:34[90m)[39m
    at subscribeToNurseCatalog [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mservices/storage/firestoreService.ts:431:12[90m)[39m
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/services/firestoreService.test.ts:235:9
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:20

 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould save a record with integrity snapshot[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould return null if record does not exist[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould perform a partial update with snapshot[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould sanitize corrupted array data from Firestore (object with numeric keys)[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould handle real-time subscriptions correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould check if firestore is available[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould fetch nurse catalog from firestore[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould save nurse catalog to firestore[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould handle catalog subscriptions correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould save TENS catalog to firestore[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould fetch TENS catalog from firestore[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould handle catalog fetch errors gracefully[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould return empty array if catalog does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/firestoreService.test.ts[2m > [22mfirestoreService[2m > [22mshould handle subscription errors[32m 2[2mms[22m[39m
[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould allow access if user is in whitelist
[22m[39m[authService] âœ… Access granted via static rule: daniel.opazo@hospitalhangaroa.cl -> admin

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould deny access and sign out if user is not in whitelist
[22m[39m[authService] ðŸ” Checking whitelist for: unknown@gmail.com

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould deny access and sign out if user is not in whitelist
[22m[39m[authService] ðŸ“¡ Querying Firestore for whitelist...

[90mstderr[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould deny access and sign out if user is not in whitelist
[22m[39m[authService] âŒ Email not found in whitelist: unknown@gmail.com

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould deny access and sign out if user is not in whitelist
[22m[39m[authService] ðŸ“¥ Firestore response received. Empty: true

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould normalize emails during check
[22m[39m[authService] ðŸ” Checking whitelist for: DANIEL.OPAZO@HOSPITALHANGAROA.CL 

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignIn[2m > [22m[2mshould normalize emails during check
[22m[39m[authService] âš¡ Role recovered from cache: admin

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignInWithGoogle[2m > [22m[2mshould succeed for authorized users
[22m[39m[authService] ðŸ” Checking whitelist for: d.opazo.damiani@gmail.com

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2msignInWithGoogle[2m > [22m[2mshould succeed for authorized users
[22m[39m[authService] âœ… Access granted via static rule: d.opazo.damiani@gmail.com -> doctor_urgency

[90mstdout[2m | tests/services/authService.test.ts[2m > [22m[2mauthService[2m > [22m[2monAuthChange[2m > [22m[2mshould handle anonymous users for signature mode
[22m[39m[authService] ðŸŽ§ Setting up onAuthStateChanged observer
[authService] ðŸ‘¤ Firebase onAuthStateChanged triggered. User: Anonymous

 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/authService.test.ts[2m > [22mauthService[2m > [22msignIn[2m > [22mshould allow access if user is in whitelist[32m 15[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/authService.test.ts[2m > [22mauthService[2m > [22msignIn[2m > [22mshould deny access and sign out if user is not in whitelist[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/authService.test.ts[2m > [22mauthService[2m > [22msignIn[2m > [22mshould normalize emails during check[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/authService.test.ts[2m > [22mauthService[2m > [22msignInWithGoogle[2m > [22mshould succeed for authorized users[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/authService.test.ts[2m > [22mauthService[2m > [22monAuthChange[2m > [22mshould handle anonymous users for signature mode[32m 3[2mms[22m[39m
[90mstdout[2m | tests/integration/flicker-free-login.test.tsx[2m > [22m[2mFlicker-Free Login Flow[2m > [22m[2mshould transition smoothly without window.location.reload when login succeeds
[22m[39mðŸ”„ Starting migration from localStorage to IndexedDB...
âœ… Migration complete!

[90mstderr[2m | tests/integration/flicker-free-login.test.tsx[2m > [22m[2mFlicker-Free Login Flow[2m > [22m[2mshould transition smoothly without window.location.reload when login succeeds
[22m[39mError: useUI must be used within a UIProvider
    at useUI [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mcontext/UIContext.tsx:71:15[90m)[39m
    at useDailyRecord [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mhooks/useDailyRecord.ts:58:34[90m)[39m
    at AppInner [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mApp.tsx:98:27[90m)[39m
    at Object.react_stack_bottom_frame [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:25904:20[90m)[39m
    at renderWithHooks [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:7662:22[90m)[39m
    at updateFunctionComponent [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:10166:19[90m)[39m
    at beginWork [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:11778:18[90m)[39m
    at runWithFiberInDEV [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:874:13[90m)[39m
    at performUnitOfWork [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:17641:22[90m)[39m
    at workLoopSync [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:17469:41[90m)[39m
    at renderRootSync [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:17450:11[90m)[39m
    at performWorkOnRoot [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:16583:35[90m)[39m
    at performWorkOnRootViaSchedulerTask [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom-client.development.js:18957:7[90m)[39m
    at flushActQueue [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact[24m/cjs/react.development.js:590:34[90m)[39m
    at process.env.NODE_ENV.exports.act [90m(/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mreact[24m/cjs/react.development.js:884:10[90m)[39m
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@testing-library[24m/react/dist/act-compat.js:47:25 {
  [stack]: [36m[Getter/Setter][39m,
  [message]: [32m'useUI must be used within a UIProvider'[39m
}

The above error occurred in the <AppInner> component.

React will try to recreate this component tree from scratch using the error boundary you provided, GlobalErrorBoundary.

[ErrorService] {
  id: [32m'err_1767160191997_nylkhzf3s'[39m,
  timestamp: [32m'2025-12-31T05:49:51.997Z'[39m,
  message: [32m'React Error Boundary: useUI must be used within a UIProvider'[39m,
  severity: [32m'critical'[39m,
  stack: [32m'\n'[39m +
    [32m'    at AppInner (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/App.tsx:60:21)\n'[39m +
    [32m'    at AuditProvider (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/tests/setup.ts:58:21)\n'[39m +
    [32m'    at App (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/App.tsx:26:48)\n'[39m +
    [32m'    at GlobalErrorBoundary (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/components/shared/GlobalErrorBoundary.tsx:9:5)\n'[39m +
    [32m'    at AppWithErrorBoundary (<anonymous>)'[39m,
  userId: [90mundefined[39m,
  userEmail: [90mundefined[39m,
  context: {
    componentStack: [32m'\n'[39m +
      [32m'    at AppInner (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/App.tsx:60:21)\n'[39m +
      [32m'    at AuditProvider (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/tests/setup.ts:58:21)\n'[39m +
      [32m'    at App (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/App.tsx:26:48)\n'[39m +
      [32m'    at GlobalErrorBoundary (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/components/shared/GlobalErrorBoundary.tsx:9:5)\n'[39m +
      [32m'    at AppWithErrorBoundary (<anonymous>)'[39m,
    errorInfo: {
      componentStack: [32m'\n'[39m +
        [32m'    at AppInner (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/App.tsx:60:21)\n'[39m +
        [32m'    at AuditProvider (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/tests/setup.ts:58:21)\n'[39m +
        [32m'    at App (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/App.tsx:26:48)\n'[39m +
        [32m'    at GlobalErrorBoundary (/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/components/shared/GlobalErrorBoundary.tsx:9:5)\n'[39m +
        [32m'    at AppWithErrorBoundary (<anonymous>)'[39m
    }
  },
  userAgent: [32m'Mozilla/5.0 (darwin) AppleWebKit/537.36 (KHTML, like Gecko) jsdom/27.3.0'[39m,
  url: [90mundefined[39m
}

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/flicker-free-login.test.tsx[2m > [22mFlicker-Free Login Flow[2m > [22mshould transition smoothly without window.location.reload when login succeeds[32m 58[2mms[22m[39m
[90mstderr[2m | tests/validation/schema-fuzzing.test.ts[2m > [22m[2mData Schema Resilience (Fuzzing)[2m > [22m[2mshould fail gracefully on totally corrupted data
[22m[39mâš ï¸ DailyRecord validation failed: [
  {
    code: [32m'invalid_type'[39m,
    expected: [32m'string'[39m,
    received: [32m'number'[39m,
    path: [ [32m'date'[39m ],
    message: [32m'Expected string, received number'[39m
  },
  {
    code: [32m'invalid_type'[39m,
    expected: [32m'object'[39m,
    received: [32m'string'[39m,
    path: [ [32m'beds'[39m ],
    message: [32m'Expected object, received string'[39m
  },
  {
    code: [32m'invalid_type'[39m,
    expected: [32m'array'[39m,
    received: [32m'null'[39m,
    path: [ [32m'discharges'[39m ],
    message: [32m'Expected array, received null'[39m
  }
]

[90mstderr[2m | tests/validation/schema-fuzzing.test.ts[2m > [22m[2mData Schema Resilience (Fuzzing)[2m > [22m[2mshould recover basic structure using parseDailyRecordWithDefaults
[22m[39mâš ï¸ Applying defaults to DailyRecord for date: 2024-12-25

[90mstderr[2m | tests/validation/schema-fuzzing.test.ts[2m > [22m[2mData Schema Resilience (Fuzzing)[2m > [22m[2mshould handle unexpected enum values in PatientData
[22m[39mâš ï¸ DailyRecord validation failed: [
  {
    received: [32m'ROBOT'[39m,
    code: [32m'invalid_enum_value'[39m,
    options: [ [32m'Masculino'[39m, [32m'Femenino'[39m, [32m'Indeterminado'[39m ],
    path: [ [32m'beds'[39m, [32m'BED_01'[39m, [32m'biologicalSex'[39m ],
    message: [32m"Invalid enum value. Expected 'Masculino' | 'Femenino' | 'Indeterminado', received 'ROBOT'"[39m
  },
  {
    received: [32m'SUPER_GRAVE'[39m,
    code: [32m'invalid_enum_value'[39m,
    options: [ [32m'Grave'[39m, [32m'De cuidado'[39m, [32m'Estable'[39m, [32m''[39m ],
    path: [ [32m'beds'[39m, [32m'BED_01'[39m, [32m'status'[39m ],
    message: [32m"Invalid enum value. Expected 'Grave' | 'De cuidado' | 'Estable' | '', received 'SUPER_GRAVE'"[39m
  }
]

 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/schema-fuzzing.test.ts[2m > [22mData Schema Resilience (Fuzzing)[2m > [22mshould fail gracefully on totally corrupted data[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/schema-fuzzing.test.ts[2m > [22mData Schema Resilience (Fuzzing)[2m > [22mshould recover basic structure using parseDailyRecordWithDefaults[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/schema-fuzzing.test.ts[2m > [22mData Schema Resilience (Fuzzing)[2m > [22mshould handle unexpected enum values in PatientData[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/schema-fuzzing.test.ts[2m > [22mData Schema Resilience (Fuzzing)[2m > [22mshould passthrough extra fields (forward compatibility)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetStoredRecords[2m > [22mreturns empty object when no data[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetStoredRecords[2m > [22mreturns parsed data when records exist[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetStoredRecords[2m > [22mreturns empty object on parse error[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22msaveRecordLocal[2m > [22msaves record to localStorage[32m 15[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22msaveRecordLocal[2m > [22mappends to existing records[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetRecordForDate[2m > [22mreturns null when record does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetRecordForDate[2m > [22mreturns record when it exists[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetAllDates[2m > [22mreturns empty array when no records[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetAllDates[2m > [22mreturns dates sorted in reverse chronological order[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetPreviousDayRecord[2m > [22mreturns null when no previous records[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mgetPreviousDayRecord[2m > [22mreturns closest previous day record[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mNurse Storage[2m > [22mreturns default nurses when no data[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mNurse Storage[2m > [22msaves and retrieves nurse list[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mdeleteRecordLocal[2m > [22mremoves specific record[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mclearAllData[2m > [22mremoves all records and nurses[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22misLocalStorageAvailable[2m > [22mreturns true when localStorage works[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mDemo Mode Storage[2m > [22mgetDemoRecords returns empty object when no data[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mDemo Mode Storage[2m > [22msaveDemoRecord saves to demo storage[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mDemo Mode Storage[2m > [22mgetAllDemoDates returns sorted dates[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mDemo Mode Storage[2m > [22mdeleteDemoRecord removes specific demo record[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mDemo Mode Storage[2m > [22mclearAllDemoData removes all demo records[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/localStorageService.test.ts[2m > [22mlocalStorageService[2m > [22mDemo Mode Storage[2m > [22mgetPreviousDemoDayRecord returns closest previous[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useClinicalCrib.test.ts[2m > [22museClinicalCrib[2m > [22mcreateCrib[2m > [22mshould create a clinical crib via patchRecord[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useClinicalCrib.test.ts[2m > [22museClinicalCrib[2m > [22mremoveCrib[2m > [22mshould remove clinical crib via patchRecord[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useClinicalCrib.test.ts[2m > [22museClinicalCrib[2m > [22mupdateCribField[2m > [22mshould update a crib field via patchRecord[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DemoModeBadge.test.tsx[2m > [22mDemoModeBadge[2m > [22mrenders nothing when demo mode is inactive[32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DemoModeBadge.test.tsx[2m > [22mDemoModeBadge[2m > [22mrenders badge when demo mode is active[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DemoModeBadge.test.tsx[2m > [22mDemoModeBadge[2m > [22mhas correct styling when visible[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mformatDateDDMMYYYY[2m > [22mshould format YYYY-MM-DD to DD-MM-YYYY[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mformatDateDDMMYYYY[2m > [22mshould return "-" if no date is provided[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mformatDateDDMMYYYY[2m > [22mshould return original string if it does not have 3 parts[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetTodayISO[2m > [22mshould return today date in YYYY-MM-DD format[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mformatDateForDisplay[2m > [22mshould format date for Spanish display[32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mdaysBetween[2m > [22mshould calculate days between two dates correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetTimeRoundedToStep[2m > [22mshould round time to default 5 minute step[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetTimeRoundedToStep[2m > [22mshould round time to custom step[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22misFutureDate[2m > [22mshould return true for a future date[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22misFutureDate[2m > [22mshould return false for today[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22misFutureDate[2m > [22mshould return false for a past date[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mparseISODate[2m > [22mshould return a Date object for a valid ISO string[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mparseISODate[2m > [22mshould return null for invalid date string[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mparseISODate[2m > [22mshould return null if no date is provided[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22misBusinessDay[2m > [22mshould return true for a regular business day[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22misBusinessDay[2m > [22mshould return false for a weekend[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22misBusinessDay[2m > [22mshould return false for a holiday[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetShiftSchedule[2m > [22mshould return correct schedule for a regular business day[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetShiftSchedule[2m > [22mshould return holiday schedule if today is a holiday[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetShiftSchedule[2m > [22mshould adjust nightEnd if tomorrow is not a business day[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/dateUtils.test.ts[2m > [22mdateUtils[2m > [22mgetShiftSchedule[2m > [22mshould adjust nightEnd if tomorrow is a business day[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientTransfers.test.ts[2m > [22musePatientTransfers[2m > [22maddTransfer[2m > [22mshould add a transfer and clear the patient from bed[32m 11[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientTransfers.test.ts[2m > [22musePatientTransfers[2m > [22mundoTransfer[2m > [22mshould restore patient to original bed[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientTransfers.test.ts[2m > [22musePatientTransfers[2m > [22maddTransfer with clinical crib[2m > [22mshould transfer both mother and baby when clinical crib exists[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientTransfers.test.ts[2m > [22musePatientTransfers[2m > [22maddTransfer validation[2m > [22mshould NOT transfer empty bed[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientTransfers.test.ts[2m > [22musePatientTransfers[2m > [22mdeleteTransfer[2m > [22mshould remove a transfer from the list[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientTransfers.test.ts[2m > [22musePatientTransfers[2m > [22mupdateTransfer[2m > [22mshould update transfer properties[32m 0[2mms[22m[39m
[90mstdout[2m | tests/hooks/useSignatureMode.test.ts[2m > [22m[2museSignatureMode[2m > [22m[2mshould sign in anonymously if in signature mode and no user is present
[22m[39m[useSignatureMode] ðŸ‘¤ No user found in signature mode, signing in anonymously...

 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useSignatureMode.test.ts[2m > [22museSignatureMode[2m > [22mshould sign in anonymously if in signature mode and no user is present[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useSignatureMode.test.ts[2m > [22museSignatureMode[2m > [22mshould NOT sign in anonymously if a user is already present (real or passport)[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useSignatureMode.test.ts[2m > [22museSignatureMode[2m > [22mshould NOT sign in anonymously if auth is loading[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useSignatureMode.test.ts[2m > [22museSignatureMode[2m > [22mshould NOT sign in if NOT in signature mode[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetDepScore[2m > [22mshould return 0 for empty scores[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetDepScore[2m > [22mshould sum all dependency fields correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetRiskScore[2m > [22mshould return 0 for empty scores[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetRiskScore[2m > [22mshould sum all risk fields correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetDepCategory[2m > [22mshould return "3" for scores 0-6 (Autosuficiencia Parcial)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetDepCategory[2m > [22mshould return "2" for scores 7-12 (Dependencia Parcial)[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetDepCategory[2m > [22mshould return "1" for scores 13-18 (Dependencia Total)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetRiskCategory[2m > [22mshould return "D" for scores 0-5 (Bajo Riesgo)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetRiskCategory[2m > [22mshould return "C" for scores 6-11 (Mediano Riesgo)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetRiskCategory[2m > [22mshould return "B" for scores 12-18 (Alto Riesgo)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetRiskCategory[2m > [22mshould return "A" for scores 19-24 (MÃ¡ximo Riesgo)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetCategoryColor[2m > [22mshould return red colors for category A[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetCategoryColor[2m > [22mshould return orange colors for category B[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetCategoryColor[2m > [22mshould return yellow colors for category C[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetCategoryColor[2m > [22mshould return green colors for category D[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetCategorization[2m > [22mshould return complete categorization for a patient[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/cudyrScoreUtils.test.ts[2m > [22mCudyrScoreUtils[2m > [22mgetCategorization[2m > [22mshould handle undefined cudyr[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/undoOperations.test.ts[2m > [22mUndo Operations[2m > [22mUndo Discharge[2m > [22mshould restore patient to empty bed after undo[32m 13[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/undoOperations.test.ts[2m > [22mUndo Operations[2m > [22mUndo Discharge[2m > [22mshould not undo if bed is already occupied[32m 12[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/undoOperations.test.ts[2m > [22mUndo Operations[2m > [22mUndo Discharge[2m > [22mshould remove discharge from list after successful undo[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/undoOperations.test.ts[2m > [22mUndo Operations[2m > [22mUndo Transfer[2m > [22mshould restore patient to empty bed after undo[32m 9[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/undoOperations.test.ts[2m > [22mUndo Operations[2m > [22mUndo Transfer[2m > [22mshould restore patient data correctly[32m 17[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mUserRole type[2m > [22mshould include nurse_hospital as a valid role[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mUserRole type[2m > [22mshould include all passport-compatible roles[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mEditor role detection[2m > [22mshould treat admin as editor[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mEditor role detection[2m > [22mshould treat editor as editor[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mEditor role detection[2m > [22mshould treat nurse_hospital as editor[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mEditor role detection[2m > [22mshould NOT treat viewer as editor[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mEditor role detection[2m > [22mshould NOT treat doctor_urgency as editor[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAuth Role Permissions[2m > [22mEditor role detection[2m > [22mshould NOT treat viewer_census as editor[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAnonymous User Detection[2m > [22mshould identify anonymous user by null email[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mAnonymous User Detection[2m > [22mshould preserve passport user data over anonymous Firebase user[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mPassport User LocalStorage[2m > [22mshould store passport user in localStorage[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mPassport User LocalStorage[2m > [22mshould retrieve passport user from localStorage[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/auth/passportAuth.test.ts[2m > [22mPassport User LocalStorage[2m > [22mshould not overwrite passport user when Firebase returns anonymous auth[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mRequest Payload Validation[2m > [22mshould construct correct request payload[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mRequest Payload Validation[2m > [22mshould include required headers[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mProduction Simulation[2m > [22mshould call correct endpoint in production[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mProduction Simulation[2m > [22mshould handle successful response[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mProduction Simulation[2m > [22mshould handle error response[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mProduction Simulation[2m > [22mshould handle network failure[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mDefault Recipients[2m > [22mshould have default recipients configured[32m 5[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mtriggerCensusEmail[2m > [22mDefault Recipients[2m > [22mshould use default recipients when none provided[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mNetlify Function Integration[2m > [22mshould have send-census-email function file[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mCensus Email Service[2m > [22mNetlify Function Integration[2m > [22mshould validate email payload structure[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mDevelopment Mode Detection[2m > [22mshould detect development mode correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/censusEmailService.test.ts[2m > [22mDevelopment Mode Detection[2m > [22mshould show helpful message in development[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-email.test.ts[2m > [22mCensus Email Integration[2m > [22mshould initialize hook with default recipients and dynamic message[32m 7[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-email.test.ts[2m > [22mCensus Email Integration[2m > [22mshould send email using fetch when confirmed (skipping isDevelopment check for test)[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/census-email.test.ts[2m > [22mCensus Email Integration[2m > [22mRecipient Logic[2m > [22mshould use test recipient when test mode is enabled[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22misAdmin[2m > [22mshould return true for admin role[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22misAdmin[2m > [22mshould return false for non-admin roles[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22misAdmin[2m > [22mshould return false for undefined role[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22misAdmin[2m > [22mshould return false for unknown role string[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanEditModule - Security Gate[2m > [22madmin should be able to edit all modules[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanEditModule - Security Gate[2m > [22mnurse_hospital should edit CENSUS, CUDYR, NURSING_HANDOFF only[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanEditModule - Security Gate[2m > [22mdoctor_urgency should NOT edit anything (read-only)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanEditModule - Security Gate[2m > [22mviewer_census should NOT edit anything[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanEditModule - Security Gate[2m > [22mundefined role should NOT edit anything[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanEditModule - Security Gate[2m > [22munknown role should NOT edit anything (security fallback)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mgetVisibleModules[2m > [22madmin should see all modules[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mgetVisibleModules[2m > [22mnurse_hospital should see CENSUS, CUDYR, NURSING_HANDOFF, MEDICAL_HANDOFF, REPORTS[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mgetVisibleModules[2m > [22mdoctor_urgency should see CENSUS, NURSING_HANDOFF, MEDICAL_HANDOFF[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mgetVisibleModules[2m > [22mviewer_census should only see CENSUS[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mgetVisibleModules[2m > [22mundefined role should default to CENSUS only[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanViewModule[2m > [22mshould return true if module is in visible list[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/permissions.test.ts[2m > [22mpermissions.ts - Security Critical Tests[2m > [22mcanViewModule[2m > [22mshould return false if module is NOT in visible list[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22minitial state[2m > [22mshould start with isOpen false and data null[32m 10[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22mopen[2m > [22mshould set isOpen to true when open is called[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22mopen[2m > [22mshould set data when open is called with initialData[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22mclose[2m > [22mshould set isOpen to false when close is called[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22mclose[2m > [22mshould clear data after animation delay[32m 8[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22mtoggle[2m > [22mshould toggle isOpen state[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/useModal.test.ts[2m > [22museModal[2m > [22mtype safety[2m > [22mshould work with complex data types[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/loggerService.test.ts[2m > [22mLoggerService[2m > [22mshould export logger instance[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/loggerService.test.ts[2m > [22mLoggerService[2m > [22mshould export log shorthand[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/loggerService.test.ts[2m > [22mLoggerService[2m > [22mshould allow setting log level[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/loggerService.test.ts[2m > [22mLoggerService[2m > [22mshould create child loggers with context[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/loggerService.test.ts[2m > [22mLoggerService[2m > [22mshould store log entries[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditServiceCoverage.test.ts[2m > [22mAuditService Coverage[2m > [22mshould catch Firestore errors silently and rely on local storage[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditServiceCoverage.test.ts[2m > [22mAuditService Coverage[2m > [22mshould call saveAuditLog regardless of Firestore status[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditServiceCoverage.test.ts[2m > [22mAuditService Coverage[2m > [22mshould exclude view logging for specific emails[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditServiceCoverage.test.ts[2m > [22mAuditService Coverage[2m > [22mshould log view access for non-excluded users[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditServiceCoverage.test.ts[2m > [22mAuditService Coverage[2m > [22mshould calculate session duration on logout[32m 0[2mms[22m[39m
[90mstdout[2m | tests/integration/audit-flow.test.ts[2m > [22m[2mAudit Flow Integration[2m > [22m[2mshould log patient admission locally and to Firestore
[22m[39mðŸ“‹ Audit log saved: PATIENT_ADMITTED BED_01

[90mstdout[2m | tests/integration/audit-flow.test.ts[2m > [22m[2mAudit Flow Integration[2m > [22m[2mshould log patient discharge with correct details
[22m[39mðŸ“‹ Audit log saved: PATIENT_DISCHARGED BED_02

[90mstdout[2m | tests/integration/audit-flow.test.ts[2m > [22m[2mAudit Flow Integration[2m > [22m[2mshould log patient view for regular users
[22m[39mðŸ“‹ Audit log saved: PATIENT_VIEWED BED_01

 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/audit-flow.test.ts[2m > [22mAudit Flow Integration[2m > [22mshould log patient admission locally and to Firestore[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/audit-flow.test.ts[2m > [22mAudit Flow Integration[2m > [22mshould log patient discharge with correct details[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/audit-flow.test.ts[2m > [22mAudit Flow Integration[2m > [22mshould NOT log patient view for admin users[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/audit-flow.test.ts[2m > [22mAudit Flow Integration[2m > [22mshould log patient view for regular users[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith array input[2m > [22mshould return the array unchanged if correct length[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith array input[2m > [22mshould pad array with empty strings if shorter than defaultLength[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith array input[2m > [22mshould truncate array if longer than defaultLength[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith array input[2m > [22mshould handle empty array[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith object input (corrupted data from dot-notation patches)[2m > [22mshould convert object with numeric keys to array[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith object input (corrupted data from dot-notation patches)[2m > [22mshould handle sparse object (missing keys)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith object input (corrupted data from dot-notation patches)[2m > [22mshould handle object with only one key[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith object input (corrupted data from dot-notation patches)[2m > [22mshould handle empty object[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith null/undefined input[2m > [22mshould return default array for null[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mwith null/undefined input[2m > [22mshould return default array for undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mfor nurse arrays (length 2)[2m > [22mshould correctly handle day shift nurses[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mfor TENS arrays (length 3)[2m > [22mshould correctly handle day shift TENS[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mensureArray Logic[2m > [22mfor TENS arrays (length 3)[2m > [22mshould correctly handle partial TENS data[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mStaff Array Sync Integration[2m > [22mshould maintain array integrity when updating nurse selections[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/ensureArray.test.ts[2m > [22mStaff Array Sync Integration[2m > [22mshould maintain array integrity when updating TENS selections[32m 0[2mms[22m[39m
[90mstdout[2m | tests/utils/optimisticUpdates.test.ts[2m > [22m[2mOptimisticUpdates[2m > [22m[2mperformOptimisticUpdate[2m > [22m[2mshould apply optimistic update immediately
[22m[39m[05:49:53.841] [DEBUG] [OptimisticUpdate] Update successful 

[90mstdout[2m | tests/utils/optimisticUpdates.test.ts[2m > [22m[2mOptimisticUpdates[2m > [22m[2mperformOptimisticUpdate[2m > [22m[2mshould accept function for optimistic state
[22m[39m[05:49:53.843] [DEBUG] [OptimisticUpdate] Update successful 

[90mstderr[2m | tests/utils/optimisticUpdates.test.ts[2m > [22m[2mOptimisticUpdates[2m > [22m[2mperformOptimisticUpdate[2m > [22m[2mshould rollback on error
[22m[39m[05:49:53.843] [WARN] [OptimisticUpdate] Rolling back due to error Error: Network error
    at [90m/Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mtests/utils/optimisticUpdates.test.ts:46:56
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:145:11
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:915:26
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1206:10[90m)[39m
    at [90mfile:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:37
    at Traces.$ [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1650:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1814:8[90m)[39m
    at runSuite [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1814:8[90m)[39m
    at runSuite [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1814:8[90m)[39m
    at runFiles [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1894:3[90m)[39m
    at startTests [90m(file:///Users/danielopazodamiani/Downloads/HHRGithub20Dic-main/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1937:3[90m)[39m

[90mstdout[2m | tests/services/auditService.test.ts[2m > [22m[2mAuditService[2m > [22m[2mshould store audit logs via indexedDBService
[22m[39mðŸ“‹ Audit log saved: PATIENT_ADMITTED BED_01

[90mstdout[2m | tests/utils/optimisticUpdates.test.ts[2m > [22m[2mOptimisticUpdates[2m > [22m[2mperformOptimisticUpdate[2m > [22m[2mshould return success true on successful update
[22m[39m[05:49:53.847] [DEBUG] [OptimisticUpdate] Update successful 

[90mstdout[2m | tests/services/auditService.test.ts[2m > [22m[2mAuditService[2m > [22m[2mshould attempt saving to firestore
[22m[39mðŸ“‹ Audit log saved: USER_LOGIN tester@hospital.cl

 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditService.test.ts[2m > [22mAuditService[2m > [22msanity check: localStorage should work[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditService.test.ts[2m > [22mAuditService[2m > [22mshould store audit logs via indexedDBService[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditService.test.ts[2m > [22mAuditService[2m > [22mshould retrieve audit logs via indexedDBService[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/auditService.test.ts[2m > [22mAuditService[2m > [22mshould attempt saving to firestore[32m 0[2mms[22m[39m
[90mstdout[2m | tests/utils/optimisticUpdates.test.ts[2m > [22m[2mOptimisticUpdates[2m > [22m[2mperformOptimisticUpdate[2m > [22m[2mshould call onSuccess callback when provided
[22m[39m[05:49:53.847] [DEBUG] [OptimisticUpdate] Update successful 

 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/optimisticUpdates.test.ts[2m > [22mOptimisticUpdates[2m > [22mperformOptimisticUpdate[2m > [22mshould apply optimistic update immediately[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/optimisticUpdates.test.ts[2m > [22mOptimisticUpdates[2m > [22mperformOptimisticUpdate[2m > [22mshould accept function for optimistic state[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/optimisticUpdates.test.ts[2m > [22mOptimisticUpdates[2m > [22mperformOptimisticUpdate[2m > [22mshould rollback on error[32m 3[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/optimisticUpdates.test.ts[2m > [22mOptimisticUpdates[2m > [22mperformOptimisticUpdate[2m > [22mshould return success true on successful update[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/optimisticUpdates.test.ts[2m > [22mOptimisticUpdates[2m > [22mperformOptimisticUpdate[2m > [22mshould call onSuccess callback when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integrations/fhir/fhirMapping.test.ts[2m > [22mFhirMappingService[2m > [22mshould map a patient to FHIR Patient resource[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integrations/fhir/fhirMapping.test.ts[2m > [22mFhirMappingService[2m > [22mshould map specific name fields (family and given)[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integrations/fhir/fhirMapping.test.ts[2m > [22mFhirMappingService[2m > [22mshould map patient to FHIR Encounter resource[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integrations/fhir/fhirMapping.test.ts[2m > [22mFhirMappingService[2m > [22mshould create a FHIR Bundle from a DailyRecord[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Data Storage[2m > [22mshould store record in localStorage[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Data Storage[2m > [22mshould retrieve record from localStorage[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Data Storage[2m > [22mshould handle missing record gracefully[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Queue[2m > [22mshould queue operations when offline[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Queue[2m > [22mshould persist queue to localStorage[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Queue[2m > [22mshould clear queue after sync[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mService Worker Cache[2m > [22mshould define cacheable resources[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mService Worker Cache[2m > [22mshould prioritize network over cache for API calls[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mService Worker Cache[2m > [22mshould fallback to cache for static assets[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mOffline Fallback Page[2m > [22mshould have offline page content[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mData Sync[2m > [22mshould detect online status[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mData Sync[2m > [22mshould merge local and remote data[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/pwaOffline.test.ts[2m > [22mPWA Offline Integration[2m > [22mData Sync[2m > [22mshould handle conflict resolution[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mCENSUS_DEFAULT_RECIPIENTS[2m > [22mshould contain expected hospital email addresses[32m 4[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mCENSUS_DEFAULT_RECIPIENTS[2m > [22mshould have at least 10 recipients[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailSubject[2m > [22mshould include "Censo diario pacientes hospitalizados"[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailSubject[2m > [22mshould include formatted date DD-MM-YYYY[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould start with "Estimados:"[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould contain the date in Spanish format[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould contain "Saludos cordiales,"[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould contain Unicode separator[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould contain "Hospital Hanga Roa"[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould contain "Anexo MINSAL 328388"[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould contain "EnfermerÃ­a - Servicio Hospitalizados"[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould include encryption PIN when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould not include encryption PIN line when not provided[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould include nurse signature when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/constants/email.test.ts[2m > [22mEmail Constants[2m > [22mbuildCensusEmailBody[2m > [22mshould have correct order: body, PIN, farewell, separator, signature[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mPatient Copying[2m > [22mshould copy occupied beds to new day[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mPatient Copying[2m > [22mshould reset CUDYR scores for new day[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mPatient Copying[2m > [22mshould copy blocked beds status[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mPatient Copying[2m > [22mshould preserve bed mode (Cama/Cuna)[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mMovement Lists[2m > [22mshould start new day with empty discharges[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mMovement Lists[2m > [22mshould start new day with empty transfers[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mMovement Lists[2m > [22mshould start new day with empty CMA[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/copyPreviousDay.test.ts[2m > [22mCopy Previous Day[2m > [22mExtra Beds[2m > [22mshould copy active extra beds[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22mcleanRut[2m > [22mshould remove dots and dashes and uppercase K[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22mformatRut[2m > [22mshould format clean RUT string[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22mformatRut[2m > [22mshould return original string if too short[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22mcalculateRutVerifier[2m > [22mshould calculate numeric verifier[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22mcalculateRutVerifier[2m > [22mshould return "0" when remainder is 11[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22mcalculateRutVerifier[2m > [22mshould return "K" when remainder is 10[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misValidRut[2m > [22mshould return true for valid RUT[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misValidRut[2m > [22mshould return false for invalid RUT[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misValidRut[2m > [22mshould return false if empty[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misValidRut[2m > [22mshould return false if too short[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misValidRut[2m > [22mshould return false if body is not numeric[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misPassportFormat[2m > [22mshould return true for passport format[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misPassportFormat[2m > [22mshould return false for purely numeric values[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/rutUtils.test.ts[2m > [22mrutUtils[2m > [22misPassportFormat[2m > [22mshould return false if empty[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientDischarges.test.ts[2m > [22musePatientDischarges[2m > [22mshould undo a discharge successfully if bed is empty[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientDischarges.test.ts[2m > [22musePatientDischarges[2m > [22mshould add a discharge for a patient[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientDischarges.test.ts[2m > [22musePatientDischarges[2m > [22mshould add discharge for patient with clinical crib[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientDischarges.test.ts[2m > [22musePatientDischarges[2m > [22mshould NOT add discharge for empty bed[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/usePatientDischarges.test.ts[2m > [22musePatientDischarges[2m > [22mshould delete a discharge[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice State[2m > [22mshould have all device options[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice State[2m > [22mshould count 0 active devices when none enabled[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice State[2m > [22mshould count active devices correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice State[2m > [22mshould toggle device state[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice Labels[2m > [22mshould have labels for all device types[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice Labels[2m > [22mshould have Spanish labels[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/components/DeviceMenu.test.tsx[2m > [22mDeviceMenu Logic[2m > [22mDevice Icons[2m > [22mshould map device types to icon names[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould return zero stats for empty beds[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould count occupied beds correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould count blocked beds correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould count clinical cribs (Cuna mode) correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould count nested clinical cribs correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould count companion cribs (RN Sano) correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould handle complex scenario: mix of beds, cribs, blocked[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould not count blocked beds in occupancy calculations[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould handle all beds blocked scenario[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould handle Cuna mode with empty patient name (resource usage)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould calculate full capacity correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould handle Cuna mode bed with nested clinical crib (double crib)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/statsCalculator.test.ts[2m > [22mstatsCalculator.ts - Critical Calculations[2m > [22mcalculateStats[2m > [22mshould count multiple companion cribs across different beds[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Scoring[2m > [22mshould start with no categories[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Scoring[2m > [22mshould count single category[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Scoring[2m > [22mshould count multiple categories[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Scoring[2m > [22mshould identify high-risk patient (all categories)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Statistics[2m > [22mshould calculate index[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Statistics[2m > [22mshould calculate category frequency[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR Statistics[2m > [22mshould identify most common category[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR in Daily Record[2m > [22mshould aggregate CUDYR for census[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/cudyrScoring.test.ts[2m > [22mCUDYR Integration[2m > [22mCUDYR in Daily Record[2m > [22mshould reset CUDYR when copying to new day[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mAdmin Role[2m > [22mshould have access to all modules[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mAdmin Role[2m > [22mshould have edit permissions for all modules[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mAdmin Role[2m > [22mshould be allowed to perform critical admin actions[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mNurse Hospital Role[2m > [22mshould have access to core clinical modules[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mNurse Hospital Role[2m > [22mshould NOT have access to AUDIT or WHATSAPP config[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mNurse Hospital Role[2m > [22mshould have edit permissions for clinical modules[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mNurse Hospital Role[2m > [22mshould NOT be allowed to delete records or read audit logs[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mNurse Hospital Role[2m > [22mshould be allowed to discharge and transfer patients[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mDoctor Urgency Role[2m > [22mshould have limited module access[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mDoctor Urgency Role[2m > [22mshould be READ-ONLY for all clinical modules[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mDoctor Urgency Role[2m > [22mshould be allowed to sign medical handoff[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mDoctor Urgency Role[2m > [22mshould NOT be allowed to write patient data or delete records[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mViewer Census Role[2m > [22mshould only see CENSUS module[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mViewer Census Role[2m > [22mshould be strictly read-only[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/permissions.test.ts[2m > [22mPermissions System (RBAC)[2m > [22mGuest / No Role[2m > [22mshould default to read-only censo access[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mDate Format Validation[2m > [22mshould accept valid YYYY-MM-DD format[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mDate Format Validation[2m > [22mshould reject invalid date formats[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mFuture Date Prevention[2m > [22mshould identify future dates correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mFuture Date Prevention[2m > [22mshould allow today date[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mFuture Date Prevention[2m > [22mshould allow past dates[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mDate Parsing[2m > [22mshould parse valid dates correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/validation/admissionDates.test.ts[2m > [22mAdmission Date Validation[2m > [22mDate Parsing[2m > [22mshould handle edge cases like year boundaries[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelBuffer[2m > [22mshould reject null buffer[32m 2[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelBuffer[2m > [22mshould reject undefined buffer[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelBuffer[2m > [22mshould reject buffer that is too small[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelBuffer[2m > [22mshould reject buffer without ZIP magic bytes[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelBuffer[2m > [22mshould accept valid XLSX buffer[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelBuffer[2m > [22mshould work with Uint8Array[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelFilename[2m > [22mshould reject null filename[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelFilename[2m > [22mshould reject empty filename[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelFilename[2m > [22mshould reject filename without .xlsx extension[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelFilename[2m > [22mshould reject filename without extension[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelFilename[2m > [22mshould accept filename with .xlsx extension[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelFilename[2m > [22mshould accept .XLSX uppercase extension[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelExport[2m > [22mshould reject invalid buffer[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelExport[2m > [22mshould reject invalid filename[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/excelValidation.test.ts[2m > [22mexcelValidation[2m > [22mvalidateExcelExport[2m > [22mshould accept valid buffer and filename[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mPatient Admission Flow[2m > [22mshould admit patient to empty bed[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mPatient Admission Flow[2m > [22mshould count occupied beds after admission[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mDischarge Flow[2m > [22mshould add discharge and clear bed[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mDischarge Flow[2m > [22mshould decrement occupied count after discharge[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mDischarge Flow[2m > [22mshould undo discharge and restore patient[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mTransfer Flow[2m > [22mshould add transfer and clear bed[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mTransfer Flow[2m > [22mshould track transfer method[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mCMA (Day Hospital) Flow[2m > [22mshould add CMA entry[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mCMA (Day Hospital) Flow[2m > [22mshould count total movements[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mBed Blocking Flow[2m > [22mshould block empty bed[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mBed Blocking Flow[2m > [22mshould affect available capacity[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mClinical Crib Flow[2m > [22mshould add clinical crib to patient bed[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/integration/censusOperations.test.ts[2m > [22mCensus Operations Integration[2m > [22mClinical Crib Flow[2m > [22mshould count total hospitalized including cribs[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22misSharedNursingAccount[2m > [22mshould return true for the shared official email[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22misSharedNursingAccount[2m > [22mshould return false for other emails[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetCurrentShift[2m > [22mshould identify day shift correctly on a working day (starts at 08:00)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetCurrentShift[2m > [22mshould identify day shift correctly on a non-working day (starts at 09:00)[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetCurrentShift[2m > [22mshould identify night shift correctly at 20:00 for both[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetNurseAuthors[2m > [22mshould return day shift nurses when inferred[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetNurseAuthors[2m > [22mshould return night shift nurses when inferred[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetNurseAuthors[2m > [22mshould return undefined if record is null[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetNurseAuthors[2m > [22mshould return undefined if shift has no nurses[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetNurseAuthors[2m > [22mshould filter out empty strings in nurses list[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetAttributedAuthors[2m > [22mshould return authors for shared account[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/admin/attributionService.test.ts[2m > [22mattributionService[2m > [22mgetAttributedAuthors[2m > [22mshould return undefined for individual account[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/patchUtils.test.ts[2m > [22mpatchUtils[2m > [22mshould update a simple top-level property[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/patchUtils.test.ts[2m > [22mpatchUtils[2m > [22mshould update a nested property using dot notation[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/patchUtils.test.ts[2m > [22mpatchUtils[2m > [22mshould auto-vivify missing paths[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/patchUtils.test.ts[2m > [22mpatchUtils[2m > [22mshould preserve other sibling properties during nested update[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/utils/patchUtils.test.ts[2m > [22mpatchUtils[2m > [22mshould handle array values correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mBlocked Beds Logic[2m > [22mshould correctly identify blocked bed[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mBlocked Beds Logic[2m > [22mshould correctly identify unblocked bed[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mBlocked Beds Logic[2m > [22mshould toggle blocked status[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mClinical Crib Logic[2m > [22mshould add clinical crib to patient[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mClinical Crib Logic[2m > [22mshould check if clinical crib exists[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mClinical Crib Logic[2m > [22mshould clear clinical crib[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mPatient Clear Logic[2m > [22mshould clear patient name[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mPatient Clear Logic[2m > [22mshould check if bed is empty[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mBed Mode Logic[2m > [22mshould toggle bed mode[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/hooks/bedOperations.test.ts[2m > [22mBed Operations Logic[2m > [22mBed Mode Logic[2m > [22mshould check companion crib status[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould format ISO date to DD-MM-YYYY[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould handle single-digit days and months[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould return dash for undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould return dash for empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould handle December correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould handle leap year February 29[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mformatDateDDMMYYYY[2m > [22mshould return original string for invalid format[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mgetTodayISO[2m > [22mshould return date in YYYY-MM-DD format[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/dataService.test.ts[2m > [22mdateFormatter[2m > [22mgetTodayISO[2m > [22mshould return today date[32m 0[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/storage/indexedDBService.test.ts[2m > [22mIndexedDB Mock - createMockDatabase[2m > [22mshould implement startsWith to prevent runtime errors in search logic[32m 1[2mms[22m[39m
 [32mâœ“[39m [30m[42m unit [49m[39m tests/services/storage/indexedDBService.test.ts[2m > [22mIndexedDB Mock - createMockDatabase[2m > [22mshould allow chaining where and equals and toArray[32m 0[2mms[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Failed Tests 4 [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m

[41m[1m FAIL [22m[49m [30m[42m unit [49m[39m tests/hooks/useBedOperations.test.ts[2m > [22museBedOperations[2m > [22mclearPatient[2m > [22mshould clear patient and call logPatientCleared if patientName exists
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'B1', 'To Clear', â€¦(2) ][90m

Number of calls: [1m0[22m
[31m[39m
[36m [2mâ¯[22m tests/hooks/useBedOperations.test.ts:[2m178:39[22m[39m
    [90m176| [39m                [32m'beds.B1'[39m[33m:[39m expect[33m.[39m[34mobjectContaining[39m({ patientName[33m:[39m [32m''[39m })
    [90m177| [39m            })[33m;[39m
    [90m178| [39m            expect(logPatientCleared).toHaveBeenCalledWith('B1', 'To Câ€¦
    [90m   | [39m                                      [31m^[39m
    [90m179| [39m        })[33m;[39m
    [90m180| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[1/4]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mgetCensusMasterFilename[2m > [22mshould generate correct filename format
[31m[1mAssertionError[22m: expected 'Censo diario HHR 23-12-2024.xlsx' to contain 'Hospital Hanga Roa'[39m

Expected: [32m"Hospital Hanga Roa"[39m
Received: [31m"Censo diario HHR 23-12-2024.xlsx"[39m

[36m [2mâ¯[22m tests/integration/census-export.test.ts:[2m262:30[22m[39m
    [90m260| [39m            // Format: "Censo Diario - Diciembre 2024 - Hospital Hangaâ€¦
    [90m261| [39m            [34mexpect[39m(filename)[33m.[39m[34mtoContain[39m([32m'2024'[39m)[33m;[39m
    [90m262| [39m            [34mexpect[39m(filename)[33m.[39m[34mtoContain[39m([32m'Hospital Hanga Roa'[39m)[33m;[39m
    [90m   | [39m                             [31m^[39m
    [90m263| [39m            [34mexpect[39m(filename)[33m.[39m[34mtoContain[39m([32m'.xlsx'[39m)[33m;[39m
    [90m264| [39m        })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[2/4]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m [30m[42m unit [49m[39m tests/integration/census-export.test.ts[2m > [22mCensus â†’ Excel Export Integration[2m > [22mgetCensusMasterFilename[2m > [22mshould include month name in Spanish
[31m[1mAssertionError[22m: expected 'censo diario hhr 15-12-2024.xlsx' to contain 'diciembre'[39m

Expected: [32m"diciembre"[39m
Received: [31m"censo diario hhr 15-12-2024.xlsx"[39m

[36m [2mâ¯[22m tests/integration/census-export.test.ts:[2m270:44[22m[39m
    [90m268| [39m
    [90m269| [39m            [90m// Should include "Diciembre" month name[39m
    [90m270| [39m            [34mexpect[39m(filename[33m.[39m[34mtoLowerCase[39m())[33m.[39m[34mtoContain[39m([32m'diciembre'[39m)[33m;[39m
    [90m   | [39m                                           [31m^[39m
    [90m271| [39m        })[33m;[39m
    [90m272| [39m    })[33m;[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[3/4]âŽ¯[22m[39m

[41m[1m FAIL [22m[49m [30m[42m unit [49m[39m tests/integration/handoff-signature.test.ts[2m > [22mHandoff â†’ Signature Integration[2m > [22mMedical Signature & WhatsApp[2m > [22mshould update medical signature with doctor name and timestamp
[31m[1mTypeError[22m: logEvent is not a function[39m
[36m [2mâ¯[22m Object.updateMedicalSignature hooks/useHandoffManagement.ts:[2m132:9[22m[39m
    [90m130| [39m
    [90m131| [39m        [90m// Audit Log[39m
    [90m132| [39m        [34mlogEvent[39m(
    [90m   | [39m        [31m^[39m
    [90m133| [39m            [32m'MEDICAL_HANDOFF_SIGNED'[39m[33m,[39m
    [90m134| [39m            [32m'dailyRecord'[39m[33m,[39m
[90m [2mâ¯[22m tests/integration/handoff-signature.test.ts:[2m143:32[22m[39m
[90m [2mâ¯[22m node_modules/@testing-library/react/dist/act-compat.js:[2m48:24[22m[39m
[90m [2mâ¯[22m process.env.NODE_ENV.exports.act node_modules/react/cjs/react.development.js:[2m814:22[22m[39m
[90m [2mâ¯[22m Proxy.<anonymous> node_modules/@testing-library/react/dist/act-compat.js:[2m47:25[22m[39m
[90m [2mâ¯[22m tests/integration/handoff-signature.test.ts:[2m142:19[22m[39m

[31m[2mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[4/4]âŽ¯[22m[39m


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m70 passed[39m[22m[90m (73)[39m
[2m      Tests [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m615 passed[39m[22m[90m (619)[39m
[2m   Start at [22m 00:49:47
[2m   Duration [22m 8.12s[2m (transform 2.92s, setup 13.69s, import 8.89s, tests 4.58s, environment 34.35s)[22m

